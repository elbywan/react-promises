{"version":3,"sources":["../src/Promise.js"],"names":["React","Component","Promise","props","state","pending","error","result","skipped","onInitAndUpdate","__unmounted","args","prevProps","prevState","promise","Error","skip","performPromise","setState","options","_backedOptions","mixin","then","catch","render","replay","bind"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\n\nexport class Promise extends Component {\n\n    constructor (props) {\n        super (props)\n        this.state = {\n            pending: null,\n            error: null,\n            result: null,\n            skipped: null\n        }\n    }\n\n    componentDidMount () {\n        this.onInitAndUpdate()\n    }\n\n    componentWillUnmount () {\n        this.__unmounted = true\n    }\n\n    setState (...args) {\n        if(!this.__unmounted)\n            super.setState(...args)\n    }\n\n    componentDidUpdate (prevProps, prevState) {\n        if(prevProps !== this.props)\n            this.onInitAndUpdate()\n    }\n\n    onInitAndUpdate () {\n        if(!this.props.promise) {\n            throw new Error('Promise function is missing.')\n        }\n        if(!this.props.skip || (typeof this.props.skip === 'function' && !this.props.skip(this.props))) {\n            this.performPromise()\n        } else {\n            this.setState({ pending: false, skipped: true })\n        }\n    }\n\n    performPromise (options = (this._backedOptions || this.props), mixin = false) {\n        const { promise } = this.props\n        this.setState({ pending: true, skipped: false })\n        this._backedOptions = mixin ? { ...options, ...this._backedOptions } : options\n        promise(options)\n            .then(result => {\n                if(typeof this.props.then === 'function') {\n                    result = this.props.then(result)\n                }\n                this.setState({ result })\n                return result\n            })\n            .catch(error => {\n                this.setState({ error })\n            })\n            .then(() => {\n                this.setState({\n                    pending: false\n                })\n            })\n    }\n\n    render () {\n        const { pending } = this.state\n        const { render } = this.props\n\n        if(pending === null) {\n            return null\n        }\n\n        return render({\n            ...this.state,\n            replay: (options, mixin = true) => this.performPromise.bind(this)(options, mixin)\n        })\n\n    }\n}"],"file":"Promise.js"}